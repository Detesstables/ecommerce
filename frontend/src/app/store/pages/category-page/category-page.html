<div class="bg-creativa-bg min-h-screen pb-20">

  @if (categoria) {
  <section
    class="relative py-32 md:py-48 text-creativa-text-white text-center bg-cover bg-center rounded-xl overflow-hidden shadow-2xl mb-12"
    [style.backgroundImage]="'linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url(' + (categoria.imagenUrl || '/assets/img/hero-bg.jpg') + ')'"
    style="
          /* Estilos para mejor visualizaci贸n de la imagen */
          background-attachment: fixed; 
          background-position: center center; 
          background-size: cover; 
          background-repeat: no-repeat; 
        ">
    <div class="relative z-10 container mx-auto px-4 max-w-4xl">
      <h1 class="text-6xl lg:text-8xl font-extrabold mb-6 leading-tight tracking-tighter">
        {{ categoria.nombre }}
      </h1>
      <p class="text-xl lg:text-2xl leading-relaxed max-w-3xl mx-auto opacity-90">
        {{ categoria.descripcion || ('Explora nuestra exclusiva colecci贸n de ' + (categoria.nombre | lowercase) + ' y
        encuentra tu pr贸xima inspiraci贸n.') }}
      </p>
    </div>
  </section>
  }

  <div class="mx-auto max-w-7xl">

    @if (isLoading) {
    <div class="p-16 text-center bg-creativa-card rounded-xl shadow-md">
      <h1 class="text-3xl font-semibold text-creativa-heading">Cargando productos...</h1>
      <p class="text-creativa-text mt-2">Un momento, la inspiraci贸n est谩 en camino...</p>
    </div>
    }

    @if (errorMessage) {
    <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-6 rounded-md shadow-md">
      <p class="font-bold text-xl">{{ errorMessage }}</p>
      <p class="text-lg">Parece que hubo un problema de conexi贸n con el servidor. Por favor, int茅ntalo de nuevo.</p>
    </div>
    }

    @if (!isLoading && !errorMessage) {

<form [formGroup]="filterForm" (ngSubmit)="onFilterSubmit()" class="mb-10 p-8 bg-creativa-card rounded-2xl shadow-xl border-t-4 border-creativa-accent">
  
  <h3 class="text-2xl font-extrabold text-creativa-heading mb-6 border-b pb-3">
     Filtros R谩pidos
  </h3>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

    <div>
      <label for="nombre" class="block text-base font-semibold text-creativa-heading mb-1">Buscar por nombre</label>
      <input 
        type="text" 
        id="nombre" 
        formControlName="nombre"
        placeholder="Ej: Cuaderno Killua..."
        class="w-full p-3 border border-gray-300 rounded-lg 
               focus:ring-2 focus:ring-creativa-primary focus:border-transparent 
               bg-creativa-secondary text-creativa-text placeholder-gray-500 transition-colors"
      />
    </div>

    <div>
      <label for="precioMin" class="block text-base font-semibold text-creativa-heading mb-1">Precio M铆nimo</label>
      <input 
        type="number" 
        id="precioMin" 
        formControlName="precioMin"
        placeholder="Desde $0"
        class="w-full p-3 border border-gray-300 rounded-lg 
               focus:ring-2 focus:ring-creativa-primary focus:border-transparent
               bg-creativa-secondary text-creativa-text placeholder-gray-500 transition-colors"
      />
    </div>

    <div>
      <label for="precioMax" class="block text-base font-semibold text-creativa-heading mb-1">Precio M谩ximo</label>
      <input 
        type="number" 
        id="precioMax" 
        formControlName="precioMax"
        placeholder="Hasta $99.999"
        class="w-full p-3 border border-gray-300 rounded-lg 
               focus:ring-2 focus:ring-creativa-primary focus:border-transparent
               bg-creativa-secondary text-creativa-text placeholder-gray-500 transition-colors"
      />
    </div>

  </div>

  <div class="flex justify-end mt-8 space-x-4">
    
    <button 
      type="submit"
      class="bg-creativa-primary text-creativa-text-white font-bold py-2 px-8 rounded-lg shadow-lg hover:bg-opacity-90 transition-colors transform hover:scale-[1.02]"
    >
      Aplicar Filtros
    </button>
    
  </div>
</form>
      @if (productos.length === 0) {
      <div class="text-center p-16 bg-creativa-card rounded-xl shadow-md border-t-8 border-creativa-accent">
        <h3 class="text-4xl font-extrabold text-creativa-heading">隆Vaya! </h3>
        <p class="text-2xl text-creativa-text mt-4">
          A煤n no tenemos productos en la categor铆a <strong>{{ categoria?.nombre }}</strong>. 隆Estamos creando cosas maravillosas!
        </p>
        <a routerLink="/"
           class="mt-6 inline-block bg-creativa-primary hover:bg-opacity-90 text-creativa-text-white font-bold py-3 px-8 rounded-lg text-lg transition-colors duration-300 shadow-md">
          Ver otras Categor铆as
        </a>
      </div>
      } @else {
      <h2 id="productos-list" class="text-3xl font-bold text-creativa-heading mb-3 pt-4">
        隆Encontramos <span class="text-creativa-primary">{{ productos.length }}</span> productos en {{ categoria?.nombre
        }}!
      </h2>
      <p class="text-lg text-creativa-text mb-10">
        Explora nuestra mejor selecci贸n de la papeler铆a m谩s dulce.
      </p>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
        @for (producto of productos; track producto.id) {
        <app-product-card [producto]="producto" [backendUrl]="backendUrl" (comprarClick)="onComprarProducto($event)" />
        }
      </div>
      }
    }
  </div>

</div>